<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>‘Big Data’ para Economía (UA) - Proyecto Final</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">‘Big Data’ para Economía (UA)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Índice</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Datos.html" rel="" target="">
 <span class="menu-text">Datos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Contenidos.html" rel="" target="">
 <span class="menu-text">Contenidos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Evaluacion.html" rel="" target="">
 <span class="menu-text">Evaluación</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./ProyectoFinal.html" rel="" target="" aria-current="page">
 <span class="menu-text">Proyecto Final</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link active" data-scroll-target="#objetivos">Objetivos</a></li>
  <li><a href="#resultado-final" id="toc-resultado-final" class="nav-link" data-scroll-target="#resultado-final">Resultado final</a></li>
  <li><a href="#plazos" id="toc-plazos" class="nav-link" data-scroll-target="#plazos">Plazos</a>
  <ul class="collapse">
  <li><a href="#elección-de-tema" id="toc-elección-de-tema" class="nav-link" data-scroll-target="#elección-de-tema">Elección de Tema</a></li>
  <li><a href="#entrega-final" id="toc-entrega-final" class="nav-link" data-scroll-target="#entrega-final">Entrega Final</a></li>
  </ul></li>
  <li><a href="#evaluación" id="toc-evaluación" class="nav-link" data-scroll-target="#evaluación">Evaluación</a>
  <ul class="collapse">
  <li><a href="#importante-plagio." id="toc-importante-plagio." class="nav-link" data-scroll-target="#importante-plagio.">IMPORTANTE: PLAGIO.</a></li>
  </ul></li>
  <li><a href="#algunas-propuestas-de-temas-y-fuentes-de-datos" id="toc-algunas-propuestas-de-temas-y-fuentes-de-datos" class="nav-link" data-scroll-target="#algunas-propuestas-de-temas-y-fuentes-de-datos">Algunas propuestas de temas y fuentes de datos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Proyecto Final</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="objetivos" class="level1">
<h1>Objetivos</h1>
<p>Para realizar este proyecto final, debéis proponer un <em>tema</em> de estudio usando datos y las técnicas que hemos visto en el curso. Más abajo os indico unas propuestas tanto de temas como de fuentes para obtener datos. También podéis proponerme un tema de estudio, usando datos de que dispongáis por trabajo, contactos, búsqueda propia, etc.</p>
<p>En cualquier caso, el resultado final debe ser un proyecto de análisis de datos que tenga sentido en el ámbito de economía, empresa, negocios, finanzas, etc. Se aplicarán los conocimientos adquiridos en el curso, quedando claras todas las etapas del análisis según el conocido flujo</p>
<center>
<img src="docs/figure/data-science-model.svg" class="img-fluid">
</center>
<p>Por tanto, debe explicarse claramente:</p>
<ol type="1">
<li><p>Objetivo del análisis: qué cuestión se analiza y su importancia</p></li>
<li><p>Datos: qué datos se utilizan, su origen, por qué son adecuados para el objetivo del análisis</p></li>
<li><p>Procesamiento de los datos (importación, limpieza y transformación): por qué es necesario para el análisis</p></li>
<li><p>Análisis exploratorio de datos: qué información básica aprendemos de los datos y cómo esto ayuda a especificar los modelos</p></li>
<li><p>Proceso de Modelización: cómo se especifican distintos modelos que ayudan a responder al objetivo y cómo se validan para obtener el mejor modelo final</p></li>
<li><p>Comunicar de manera efectiva mediante gráficos, resultados de estimación, etc. las implicaciones de los resultados obtenidos en el análisis para el objetivo. En particular, explicar cómo los resultados responden a la cuestión económica, financiera o decisión de empresa que se plantea cómo objetivo.</p></li>
</ol>
<p><strong>LA INFORMACIÓN SOBRE EL PROYECTO FINAL SE IRÁ ACTUALIZANDO A LO LARGO DEL CURSO</strong></p>
</section>
<section id="resultado-final" class="level1">
<h1>Resultado final</h1>
<p>Se debe crear un informe con Quarto con un título adecuado, vuestro nombre completo en el campo de autor, etc. Debe incluir secciones y cualquier elemento habitual en un documento que consideréis necesario (listas, imágenes, …) además del código cuando sea oportuno. Por favor, intentad que el trabajo sea <strong>mínimamente presentable</strong> y profesional; estos años en la Universidad os deben haber proporcionado las capacidades y las herramientas para que vuestro trabajo sea un mini-informe que presentaríais si estuvieseis trabajando. Sin perder excesivo tiempo en una forma perfecta de presentación, no produzcáis un documento con tablas y gráficos difíciles de leer o poco informativos, con una estructura inconexa, etc. No se trata de “amontonar” resultados, sino de presentar una historia que los datos nos cuentas.</p>
<p>Durante el curso aprenderemos herramientas para realizar el informe.</p>
<p>Como es habitual, deberéis entregar un archivo .qmd y el resultado de renderizarlo (un archivo .html, .pdf o .docx). También se adjuntarán otros archivos que fueran necesarios para <strong>reproducir</strong> totalmente el documento o archivos complementarios que consideréis importantes (tanto la carpeta asociada al .html como archivos de datos, archivos de código R complementario, etc.).</p>
<p>Los nombres de los TODOS archivos DEBEN seguir el siguiente formato que incluye vuestro número de DNI: ej.,</p>
<ul>
<li><p>Final_123456789.qmd</p></li>
<li><p>Final_123456789.html</p></li>
<li><p>Final_123456789.zip</p></li>
</ul>
</section>
<section id="plazos" class="level1">
<h1>Plazos</h1>
<section id="elección-de-tema" class="level2">
<h2 class="anchored" data-anchor-id="elección-de-tema">Elección de Tema</h2>
<ul>
<li><p>Por favor, cumplimentad este <a href="https://docs.google.com/forms/d/e/1FAIpQLSeXKdPGtTpsXfSh3XZXn3JKN1Q8bx_qMy-Z4w9DQ0IrIPLHHA/viewform">FORMULARIO</a> con vuestra <strong>propuesta de tema</strong> para el proyecto.</p></li>
<li><p>Deben queda claro los objetivos/utilidad de hacer del análisis que proponéis; debéis indicar qué datos usaréis y comentar brevemente cómo pensáis hacerlo (si haréis regresión o clasificación, tipo de algoritmos, etc.)</p></li>
<li><p>Aunque no pondré plazo formal, os recomiendo hacer esto cuanto antes y, como fecha orientativa, del <strong>jueves, 28 de diciembre de 2023</strong>.</p>
<ul>
<li><p>Cuanto antes lo hagáis, antes podéis empezar a organizaros y trabajar</p></li>
<li><p>PERO debéis esperar a que os dé mi visto bueno sobre vuestra propuesta para asegurarme de que vuestra propuesta tiene sentido y, por ejemplo, que dos estudiantes diferentes NO hacen el mismo trabajo (los datos pueden ser los mismos, pero NO con el mismo objetivo.)</p></li>
</ul></li>
</ul>
<ul>
<li>En cualquier momento podéis consultarme dudas relativas al trabajo. Si fuera necesario, en enero podemos tener tanto tutorías presenciales, preferentemente coordinadas entre varios, para poder reservar un aula.</li>
</ul>
</section>
<section id="entrega-final" class="level2">
<h2 class="anchored" data-anchor-id="entrega-final">Entrega Final</h2>
<ul>
<li>El trabajo en su formato final deberá entregarse antes del <strong>jueves, 1 de febrero de 2024</strong> (hora límite 23:55h de la noche) por medio de este <a href="https://docs.google.com/forms/d/e/1FAIpQLSdYMg3LtT4SaxIIMhVt2BDOyZfO2oeY578RPcWO8XYWvCiBIQ/viewform">FORMULARIO</a></li>
</ul>
</section>
</section>
<section id="evaluación" class="level1">
<h1>Evaluación</h1>
<p>En la nota de trabajo se valorará la complejidad de todo el proceso del análisis. No es lo mismo usar unos datos sencillos y ya preparados que necesitar varias fuentes de datos y combinarlas, usar datos que requieran mucha limpieza o complejos de analizar por el número de observaciones o variables, etc. Asimismo, la profundidad tanto del análisis exploratorio como de los modelos finales y su evaluación se tendrá en cuenta; hacer los más básico visto en clase con unos datos similares a los de clase es válido, pero incluso estando perfecto no podéis esperar la máxima nota.</p>
<section id="importante-plagio." class="level2">
<h2 class="anchored" data-anchor-id="importante-plagio.">IMPORTANTE: PLAGIO.</h2>
<ul>
<li><p>Seguro que podéis encontrar análisis ya realizados sobre vuestra propuesta, en internet o de estudiantes de cursos anteriores. Yo también.</p></li>
<li><p>La detección de plagio supondrá automáticamente el suspenso en todas las convocatorias de la asignatura en este curso académico y el inicio de la <strong>apertura de un expediente</strong>.</p></li>
</ul>
<p>No es la primera vez que estos datos u otros que me propongáis vosotros se han utilizado. Seguro que podéis encontrar análisis ya realizados sobre vuestra propuesta, en internet o de estudiantes de cursos anteriores. <strong>Yo también</strong>. </p>
</section>
</section>
<section id="algunas-propuestas-de-temas-y-fuentes-de-datos" class="level1">
<h1>Algunas propuestas de temas y fuentes de datos</h1>
<ol type="1">
<li><p><strong>Ventas de “Big Mart”</strong>. Se han recopilado datos de ventas de 1.559 productos para el 2013 en 10 tiendas en diferentes ciudades para la cadena de tiendas americana “Big Mart”. Además, se han definido determinados atributos de cada producto y tienda. El objetivo es construir un modelo predictivo o de clasificación para conocer las ventas de cada producto en una tienda concreta. Con este modelo, se intentará comprender las propiedades de los productos y tiendas que juegan un papel clave en las ventas. Los datos están <a href="https://drive.google.com/file/d/1Tcr85g-zl_i1XdgAmljcvrB3Dq3_L9d4/view?usp=sharing">aquí</a> </p></li>
<li><p><strong>Black Friday</strong>. “ABC Private Limited” quiere comprender el comportamiento de compra para varios productos de diferentes categorías. Se dispone de un resumen de compras de varios clientes y sus datos demográficos. Un modelo para predecir comprar o clasificar compras de gran volumen del cliente ayudará a crear una oferta personalizada para los clientes. Los datos <a href="https://www.dropbox.com/s/37m2nynxxjzmxta/02black.csv?dl=0">aquí</a> </p></li>
<li><p><strong>Concesión de préstamos</strong>. “Dream Housing Finance” desea automatizar el proceso de elegibilidad del préstamo a partir de datos del cliente proporcionados al llenar el formulario de solicitud en línea. Para automatizar este proceso, han planteado un problema a la hora de identificar los segmentos de clientes, que son susceptibles de recibir préstamos para poder dirigirse específicamente a estos clientes. Los datos y su descripción <a href="https://www.dropbox.com/s/5h7g2vped3qpbkk/03loan.zip?dl=0">aquí</a> </p></li>
<li><p><strong>Clasificación de la calidad crediticia</strong>. Datos de una compañía de tarjetas de crédito alemana, <a href="https://archive.ics.uci.edu/ml/datasets/Statlog+%28German+Credit+Data%29">aquí</a> </p></li>
<li><p><strong>Servicio de bicicletas</strong>. La empresa “Capital BikeShare” ofrece un servicio de bicicletas compartidas. Quiere saber a dónde van sus usuarios, cuándo viajan, qué paradas son las más populares, en qué días de la semana se realizan más viajes. Información <a href="https://www.capitalbikeshare.com/system-data">aquí</a> </p></li>
<li><p><strong>Precios de las casas</strong></p>
<ol type="a">
<li><p>Disponemos de información describiendo (casi) todos los aspectos de las casas residenciales en <strong>Ames, Iowa</strong>, para predecir el precio final de cada casa. Datos y descripción <a href="https://www.dropbox.com/s/zvvfs88xn8dt4no/07houses.zip?dl=0">aquí</a>. </p></li>
<li><p>Datos extraídos de la <em>American Community Survey</em> de 2011 con información sobre el parque de viviendas y las circunstancias económicas de cada área en <strong>California y Pennsylvania</strong>. Datos e información <a href="https://www.dropbox.com/s/qic1yskj2gurcu3/08calif.zip?dl=0">aquí</a>. </p></li>
<li><p>Datos se han extraído de los resultados públicos publicados cada semana en <a href="http://domain.com.au" class="uri">http://domain.com.au</a> con información sobre precios de las casa en <strong>Melbourne, Australia</strong>. Datos e información <a href="https://drive.google.com/file/d/1zz8kjIhEGSfKOS6YQOnSOEAoDKivQl0m/view?usp=sharing">aquí</a></p></li>
</ol></li>
<li><p><strong>Delitos</strong>.</p>
<ol type="a">
<li><p>Datos e información <a href="https://data.cityofchicago.org/Public-Safety/Crimes-2001-to-present/ijzp-q8t2">aquí</a> sobre los crímenes cometidos en <strong>Chicago</strong> desde 2001. Se puede utilizar para predecir el tipo de crimen, incidencia de crímenes por tipo y zona, etc. Esta información se puede complementar con otras fuentes del mismo portal de datos de Chicago (en particular, datos de socioeconomicos de los vecindarios).</p></li>
<li><p>También existe información para Boston <a href="https://data.boston.gov/dataset/crime-incident-reports-july-2012-august-2015-source-legacy-system">aquí</a> y <a href="https://data.boston.gov/dataset/crime-incident-reports-august-2015-to-date-source-new-system">aquí</a> y más información en el mismo sitio (p.e., datos socioeconomicos de los vecindarios) </p></li>
</ol></li>
<li><p><strong>Propinas en taxis de NY</strong>. Analizar los determinantes de que la propina sea alta, en función del lugar de origen, destino, etc. Los datos <a href="https://www.dropbox.com/s/zaptbme1txrhdhi/10taxis.zip?dl=0">aquí</a>. </p></li>
<li><p><strong>Airbnb</strong>. En este <a href="http://tomslee.net/airbnb-data-collection-get-the-data">enlace</a> están disponibles conjuntos de datos obtenidos de la web de Airbnb para diferentes ciudades (Alicante no está incluida, pero podéis hacer el “web scraping” si queréis…). Entre otras cosas, se puede analizar los determinantes de la satisfación de los usuarios. Notad que esta fuente da para varios trabajos, tanto por usar distintas ciudades (cuidado con trabajos “demasiado” similares) como porque, como con otros datos, se pueden analizar más de una cosa. </p></li>
<li><p><strong>Precio de las acciones</strong>. Usando información sobre fundamentales de las acciones, se puede predecir el valor o determinar (clasificar) si están sobrevaloradas o infravaloradas. Podéis utilizar <a href="http://www.usfundamentals.com/download/">estos datos</a> o buscar vuestros propios datos de otras empresas (por ejemplo, españolas). </p></li>
<li><p><strong>Predicción de Respuesta del Cliente</strong> y maximización de beneficios. Datos de una campaña de “mailing” directo a clientes con información sobre características demográficas de los clientes y su historial. El objetivo es predecir la respuesta de los clientes en caso de ser contactados para fines de donación. Al clasificar a los clientes, se puede maximizar el importe de la donación. Datos y descripción <a href="https://www.dropbox.com/s/9hfftmdbgrerv6h/13respuesta.zip?dl=0">aquí</a>. </p></li>
<li><p><strong>Stock pairs</strong> es un estrategia de “trading” desarrollada por “Morgan Stanley” en los años 1980 (ver <a href="https://en.wikipedia.org/wiki/Pairs_trade">aquí</a>). Si dos precios de acciones o índices bursátiles como Dow Jones y S&amp;P 500 están históricamente correlados, la ratio de precios tiene un valor estable. Si la ratio de precio se desvía significativamente de ese valor indica que una está infravalorada y deberá subir. El objetivo es desarrollar un modelo que prediga una subida en función de valores pasados de la ratio. Se podrían utilizar dos series de precios de acciones cualquiera, PERO este trabajo es más complejo de lo que parece: se requiere información adicional de fundamentales, una modelización ARIMA apropiada, etc. Consultad conmigo ANTES de elegir esto. </p></li>
<li><p><a href="https://github.com/datawookie/trundler">Este paquete</a> de R acceso a los datos de productos y precios históricos de una serie de minoristas en línea.</p></li>
<li><p><a href="https://www.kaggle.com/aungpyaeap/supermarket-sales">Este conjunto de datos</a> contiene información sobre las ventas históricas de una compañía de supermercados.</p></li>
<li><p>Se pueden utilizar encuestas oficiales para <strong>predecir la pobreza</strong> de los hogares. Si os interesa, preguntadme.</p></li>
</ol>
<p>Otras fuentes generales son:</p>
<ul>
<li><p>https://www.kaggle.com/datasets</p></li>
<li><p>https://github.com/caesar0301/awesome-public-datasets</p></li>
<li><p>https://www.kdnuggets.com/datasets/index.html</p></li>
<li><p>https://github.com/rfordatascience/tidytuesday</p></li>
<li><p>https://www.data.gov/</p></li>
<li><p>https://data.worldbank.org/</p></li>
<li><p>https://github.com/fivethirtyeight/data</p></li>
<li><p>https://aws.amazon.com/datasets/</p></li>
<li><p>https://cloud.google.com/bigquery/public-data/</p></li>
<li><p>https://www.quandl.com/</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>